<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.110.0"><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png><link rel=manifest href=/favicons/site.webmanifest><link rel="shortcut icon" href=/favicons/favicon.ico><title>自己搭建一个Electron + React + umi 的通用模板 - {...Life}</title><meta name=author content="WannTonn"><meta name=keywords content="Electron"><meta property="og:title" content="自己搭建一个Electron + React + umi 的通用模板"><meta property="og:description" content="
前言：想自己构建一个通用模板。减去重复开发工作，并且可以在其中学习到更多知识。
"><meta property="og:type" content="article"><meta property="og:url" content="https://blogs.wanntonn.fun/fed/electron/create-a-demo-template/"><meta property="og:image" content="https://blogs.wanntonn.fun/images/Post/Electron/bg.jpg"><meta property="article:published_time" content="2022-03-06T11:30:45+08:00"><meta property="article:modified_time" content="2022-03-06T11:30:45+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blogs.wanntonn.fun/images/Post/Electron/bg.jpg"><meta name=twitter:title content="自己搭建一个Electron + React + umi 的通用模板"><meta name=twitter:description content="
前言：想自己构建一个通用模板。减去重复开发工作，并且可以在其中学习到更多知识。
"><link rel=stylesheet href=/assets/amzrk2.min.css><script></script><body data-theme=auto data-section=single><script>!function(e){let t;try{t=JSON.parse(localStorage.getItem("amzrk2-theme"))}catch{t=null}t&&t!==e&&document.body.setAttribute("data-theme",t)}(document.body.getAttribute("data-theme"))</script><div id=top style=height:0;overflow:hidden></div><header><nav class=navbar><div class=container><div class=navbar-brand><a class=navbar-item href=https://blogs.wanntonn.fun>{...Life}</a></div><div class=navbar-menu><div class=navbar-start><a class=navbar-item href=/post/>笔记</a>
<a class=navbar-item href=/fed/>前端</a>
<a class=navbar-item href=/hackintosh/>Hackintosh</a>
<a class=navbar-item href=/tags/>标签</a>
<a class=navbar-item href=/about/>关于</a></div><div class=navbar-end><div class=navbar-item id=ctrl-adjust><svg class="icon" aria-hidden="true"><use xlink:href="#icon-adjust"/></svg></div><a class=navbar-item id=ctrl-rss href=/%20/index.xml target=_blank><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss"/></svg></a><div class=navbar-item id=ctrl-toc><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bars"/></svg></div></div></div></nav></header><main><div class="container single-container"><div class="columns single-columns"><div class="column single-content is-three-quarters"><div class=card><div class="post-image image-wrapper ratio-32x9"><img src=/images/Post/Electron/bg.jpg></div><div class=post-box><h2 class=post-title>自己搭建一个Electron + React + umi 的通用模板</h2><div class=post-meta><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-day"/></svg>&nbsp;<time>2022-03-06</time></span>
<span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clock"/></svg>&nbsp;5 min</span>
<span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hashtag"/></svg>&nbsp;<a href=/tags/electron>Electron</a></span></div></div><div class=post-content><article class="markdown content"><blockquote><p>前言：想自己构建一个通用模板。减去重复开发工作，并且可以在其中学习到更多知识。</p></blockquote><p><a href=https://github.com/WannTonn/electron-umi-template target=_blank>先上链接</a></p><h3 id=使用-umi-创建-react-项目此处为-macos-环境>使用 Umi 创建 React 项目(此处为 MacOS 环境)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkdir umi-demo  <span style=color:#75715e># 创建umi-demo文件夹</span>
</span></span><span style=display:flex><span>$ cd umi-demo <span style=color:#75715e># 到umi-demo 文件夹下</span>
</span></span><span style=display:flex><span>$ yarn create umi <span style=color:#75715e># 用yarn 创建umi项目, yarn的安装方法此处不做讨论</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ <span style=color:#f92672>[</span>1/4<span style=color:#f92672>]</span> 🔍  Resolving packages...
</span></span><span style=display:flex><span>warning create-umi &gt; sylvanas &gt; @umijs/fabric &gt; stylelint &gt; @stylelint/postcss-markdown@0.36.2: Use the original unforked package instead: postcss-markdown
</span></span><span style=display:flex><span>warning create-umi &gt; yeoman-environment &gt; globby &gt; fast-glob &gt; micromatch &gt; snapdragon &gt; source-map-resolve@0.5.3: See https://github.com/lydell/source-map-resolve#deprecated
</span></span><span style=display:flex><span>warning create-umi &gt; yeoman-environment &gt; globby &gt; fast-glob &gt; micromatch &gt; snapdragon &gt; source-map-resolve &gt; resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated
</span></span><span style=display:flex><span>warning create-umi &gt; yeoman-environment &gt; globby &gt; fast-glob &gt; micromatch &gt; snapdragon &gt; source-map-resolve &gt; urix@0.1.0: Please see https://github.com/lydell/urix#deprecated
</span></span><span style=display:flex><span>warning create-umi &gt; yeoman-environment &gt; globby &gt; fast-glob &gt; micromatch &gt; snapdragon &gt; source-map-resolve &gt; source-map-url@0.4.1: See https://github.com/lydell/source-map-url#deprecated
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2/4<span style=color:#f92672>]</span> 🚚  Fetching packages...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>3/4<span style=color:#f92672>]</span> 🔗  Linking dependencies...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>4/4<span style=color:#f92672>]</span> 🔨  Building fresh packages...
</span></span><span style=display:flex><span>success Installed <span style=color:#e6db74>&#34;create-umi@0.27.0&#34;</span> with binaries:
</span></span><span style=display:flex><span>      - create-umi
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ? Select the boilerplate type app   <span style=color:#75715e># 选择模板，此处选择了普通app模板</span>
</span></span><span style=display:flex><span>? Do you want to use typescript? Yes  <span style=color:#75715e># 启用typescript</span>
</span></span><span style=display:flex><span>? What functionality <span style=color:#66d9ef>do</span> you want to enable? <span style=color:#75715e># 此处选择antd</span>
</span></span><span style=display:flex><span>   create package.json
</span></span><span style=display:flex><span>   create src/assets/yay.jpg
</span></span><span style=display:flex><span>   create .gitignore
</span></span><span style=display:flex><span>   create .editorconfig
</span></span><span style=display:flex><span>   create .env
</span></span><span style=display:flex><span>   create .eslintrc
</span></span><span style=display:flex><span>   create .prettierignore
</span></span><span style=display:flex><span>   create .prettierrc
</span></span><span style=display:flex><span>   create .umirc.ts
</span></span><span style=display:flex><span>   create mock/.gitkeep
</span></span><span style=display:flex><span>   create src/global.css
</span></span><span style=display:flex><span>   create src/layouts/__tests__/index.test.tsx
</span></span><span style=display:flex><span>   create src/layouts/index.css
</span></span><span style=display:flex><span>   create src/layouts/index.tsx
</span></span><span style=display:flex><span>   create src/pages/__tests__/index.test.tsx
</span></span><span style=display:flex><span>   create src/pages/index.css
</span></span><span style=display:flex><span>   create src/pages/index.tsx
</span></span><span style=display:flex><span>   create tsconfig.json
</span></span><span style=display:flex><span>   create typings.d.ts
</span></span><span style=display:flex><span>✨ File Generate Done
</span></span><span style=display:flex><span>✨  Done in 74.72s.
</span></span></code></pre></div><h3 id=安装依赖与运行项目>安装依赖与运行项目</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ yarn
</span></span><span style=display:flex><span>yarn install v1.22.17
</span></span><span style=display:flex><span>info No lockfile found.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1/5<span style=color:#f92672>]</span> 🔍  Validating package.json...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2/5<span style=color:#f92672>]</span> 🔍  Resolving packages...
</span></span><span style=display:flex><span>warning babel-eslint@9.0.0: babel-eslint is now @babel/eslint-parser. This package will no longer receive updates.
</span></span><span style=display:flex><span>...此处省略N行
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>5/5<span style=color:#f92672>]</span> 🔨  Building fresh packages...
</span></span><span style=display:flex><span>success Saved lockfile.
</span></span><span style=display:flex><span>✨  Done in 89.98s.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ yarn start
</span></span><span style=display:flex><span>yarn run v1.22.17
</span></span><span style=display:flex><span>$ umi dev
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>✔ Webpack
</span></span><span style=display:flex><span>  Compiled successfully in 3.56s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Starting the development server...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> DONE  Compiled successfully in 3566ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  App running at:
</span></span><span style=display:flex><span>  - Local:   http://localhost:8000/ <span style=color:#f92672>(</span>copied to clipboard<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  - Network: http://10.100.8.41:8000/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> WAIT  Compiling...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>✔ Webpack
</span></span><span style=display:flex><span>  Compiled successfully in 166.94ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> DONE  Compiled successfully in 168ms
</span></span></code></pre></div><p>这里 umi 项目就已经安装并成功运行了。</p><h3 id=准备安装-electron>准备安装 Electron</h3><blockquote><p>在安装 Electron 之前，先调整项目的目录，这里分析一下为什么要调整项目的目录以及操作以下动作。</p><ol><li>为了优化 Electron 的安装包的体积，</li></ol></blockquote><ol><li>按下 <code>ctrl + c</code> ,先停止本地服务</li><li>在项目根目录创建 <code>renderer</code> 文件夹(可以理解为 Electron 中的渲染进程)</li><li>将刚刚生成的所有文件(<code>.gitignore</code>文件除外)移动到<code>renderer</code>文件夹下。</li><li>在项目中创建<code>main</code>文件夹(Electron 项目的主进程)</li><li>在项目根目录创建<code>index.js</code></li><li>在终端输入以下指令</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>  $ npm init <span style=color:#f92672>(</span>初始化项目，用于安装Electron，根据需要初始化<span style=color:#f92672>)</span>
</span></span></code></pre></div><h4 id=安装-electron>安装 Electron</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ yarn add electron -D
</span></span></code></pre></div><h4 id=配置mainmainjs-主进程内容>配置<code>main/main.js</code> 主进程内容</h4><details><summary>点击查看</summary><p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>app</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>BrowserWindow</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ipcMain</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>nativeTheme</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Menu</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MenuItem</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Notification</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>globalShortcut</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>webContents</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ipcRenderer</span>,
</span></span><span style=display:flex><span>} <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;electron&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>path</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;path&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isMac</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>platform</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;darwin&#39;</span>; <span style=color:#75715e>// 如果是MacOS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isWin</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>platform</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;win32&#39;</span>; <span style=color:#75715e>// 如果是Windows
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isDev</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>NODE_ENV</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;development&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>getRootPath</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;../rootPath&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>windowIdMap</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description 初始化创建窗口
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param name 窗口的名称
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>createWindow</span>(<span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>option</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mainWindow</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>BrowserWindow</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1000</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>800</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>webPreferences</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>nodeIntegration</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>contextIsolation</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>webviewTag</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>enableRemoteModule</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>preload</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>join</span>(<span style=color:#a6e22e>getRootPath</span>(), <span style=color:#e6db74>&#39;static&#39;</span>, <span style=color:#e6db74>&#39;electron-preload.js&#39;</span>),
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>windowIdMap</span>[<span style=color:#a6e22e>name</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>mainWindow</span>.<span style=color:#a6e22e>webContents</span>.<span style=color:#a6e22e>id</span>; <span style=color:#75715e>// 将窗口名称设置到map
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isDev</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mainWindow</span>.<span style=color:#a6e22e>loadURL</span>(<span style=color:#e6db74>&#39;http://localhost:8000&#39;</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mainWindow</span>.<span style=color:#a6e22e>loadFile</span>(<span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>join</span>(<span style=color:#a6e22e>getRootPath</span>(), <span style=color:#e6db74>&#39;/dist/index.html&#39;</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mainWindow</span>.<span style=color:#a6e22e>webContents</span>.<span style=color:#a6e22e>openDevTools</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description 配置菜单,需要开启的话就将注释去掉，修改内容
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* const menu = new Menu();
</span></span></span><span style=display:flex><span><span style=color:#75715e>menu.append(new MenuItem({
</span></span></span><span style=display:flex><span><span style=color:#75715e>  submenu: [{
</span></span></span><span style=display:flex><span><span style=color:#75715e>    label: &#39;退出&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>    role: &#39;quit&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>    accelerator: isMac ? &#39;Cmd+Q&#39; : &#39;Alt+F4&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>    click: () =&gt; { console.log(&#39;close app&#39;); }
</span></span></span><span style=display:flex><span><span style=color:#75715e>  }, {
</span></span></span><span style=display:flex><span><span style=color:#75715e>    label: &#39;老板键&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>    role: &#39;hide&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>    accelerator: isMac ? &#39;Cmd+H&#39; : &#39;Win+D&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e>  }]
</span></span></span><span style=display:flex><span><span style=color:#75715e>})); */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Menu.setApplicationMenu(menu);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description 弹一个通知
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>showNotification</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>NOTICE_TITLE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;成功初始化&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>NOTICE_CONTENT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;恭喜初始化成功&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Notification</span>({ <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>NOTICE_TITLE</span>, <span style=color:#a6e22e>body</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>NOTICE_CONTENT</span> }).<span style=color:#a6e22e>show</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description 当是MacOS的时候
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 切换暗黑模式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isMac</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ipcMain</span>.<span style=color:#a6e22e>handle</span>(<span style=color:#e6db74>&#39;dark-mode:toggle&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>nativeTheme</span>.<span style=color:#a6e22e>themeSource</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>nativeTheme</span>.<span style=color:#a6e22e>shouldUseDarkColors</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;light&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dark&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>nativeTheme</span>.<span style=color:#a6e22e>shouldUseDarkColors</span>;
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ipcMain</span>.<span style=color:#a6e22e>handle</span>(<span style=color:#e6db74>&#39;dark-mode:system&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>nativeTheme</span>.<span style=color:#a6e22e>themeSource</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;system&#39;</span>;
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description 绑定主进程响应渲染进程的通信
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ipcMain</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;login&#39;</span>, (<span style=color:#a6e22e>e</span>, <span style=color:#a6e22e>opt</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> { <span style=color:#a6e22e>msg</span>, <span style=color:#a6e22e>callback</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>opt</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>msg</span>, <span style=color:#a6e22e>callback</span>, <span style=color:#a6e22e>opt</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>callback</span><span style=color:#f92672>?</span>.();
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ipcMain</span>.<span style=color:#a6e22e>handle</span>(<span style=color:#e6db74>&#39;toMain&#39;</span>, (<span style=color:#a6e22e>callBack</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>callBack</span><span style=color:#f92672>?</span>.();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;我是main窗口，create window success&#39;</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description 当electron初始化完成的时候
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>app</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>whenReady</span>()
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>globalShortcut</span>.<span style=color:#a6e22e>register</span>(<span style=color:#e6db74>&#39;F12&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>webContents</span>.<span style=color:#a6e22e>fromId</span>(<span style=color:#a6e22e>windowIdMap</span>[<span style=color:#e6db74>&#39;default&#39;</span>])<span style=color:#f92672>?</span>.<span style=color:#a6e22e>openDevTools</span>();
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>createWindow</span>(<span style=color:#e6db74>&#39;default&#39;</span>);
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>then</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>isMac</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>showNotification</span>();
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description 当没有窗口打开时，则打开一个新窗口（MacOS）
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;activate&#39;</span>, <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>BrowserWindow</span>.<span style=color:#a6e22e>getAllWindows</span>().<span style=color:#a6e22e>length</span>) <span style=color:#a6e22e>createWindow</span>();
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description 当electron关闭所有窗口时，退出应用。
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;mainWindow-all-closed&#39;</span>, <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isWin</span>) <span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>quit</span>();
</span></span><span style=display:flex><span>});
</span></span></code></pre></div></p></details><h3 id=修改根目录indexjs>修改根目录<code>index.js</code></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./main/main.js&#39;</span>);
</span></span></code></pre></div><h3 id=修改根目录packagejson>修改根目录<code>package.json</code></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#960050;background-color:#1e0010>找到scripts,</span> <span style=color:#960050;background-color:#1e0010>添加start指令</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;scripts&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;test&#34;</span>: <span style=color:#e6db74>&#34;echo \&#34;Error: no test specified\&#34; &amp;&amp; exit 1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;electron .&#34;</span>
</span></span><span style=display:flex><span>}<span style=color:#960050;background-color:#1e0010>,</span>
</span></span></code></pre></div><h3 id=运行-electron>运行 Electron</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ yarn start
</span></span></code></pre></div><h3 id=细节修改>细节修改</h3><blockquote><p>由于<code>main/main.js</code>是修改过的，入口增加了是否是 development 的判断(是：打开 http://localshost:8000, 否：打开编译好的正式包文件下的 index.html)，所以这里需要调整<code>package.json</code>，在<code>start</code>指令中添加 监听 <code>http://localhost:8000</code> 并启动 Electron 客户端。
修改根目录下的<code>package.json</code></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;scripts&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;elt:dev&#34;</span>: <span style=color:#e6db74>&#34;cross-env NODE_ENV=development electron .&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;concurrently \&#34;npm run start:app\&#34; \&#34;wait-on http://localhost:8000 &amp;&amp; npm run elt:dev\&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;start:app&#34;</span>: <span style=color:#e6db74>&#34;cross-env APP_ROOT=./renderer umi dev&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>在运行 <code>yarn start</code>之前，先安装对应的依赖。因为指令中用到了
<a href=https://www.npmjs.com/package/concurrently target=_blank>concurrently</a>
与
<a href=https://www.npmjs.com/package/wait-on target=_blank>wait-on</a>
。所以我们需要先安装依赖(需要安装到<code>devDependencies</code>下，因为在后续的打包中，Electron 不会将<code>devDependencies</code>下的依赖打包进去。进而优化整体体积)。</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ yarn add wait-on concurrently -D
</span></span></code></pre></div><h3 id=再次运行-electron>再次运行 Electron</h3><pre tabindex=0><code>$ yarn start
</code></pre><h3 id=安装electron-builder>安装<code>electron-builder</code></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ yarn add electron-builder
</span></span></code></pre></div><h3 id=添加electron-builder配置>添加<code>electron-builder</code>配置</h3><p>新增<code>electron-builder-config.js</code>（名字随意起）。仅供参考。具体按实际场景修改</p><details><summary>点击查看配置</summary><p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @description
</span></span></span><span style=display:flex><span><span style=color:#75715e> * electron-builder配置文件， 使用时通过npmscript 指定--config 来匹配运行
</span></span></span><span style=display:flex><span><span style=color:#75715e> * eg(当前)： elctron-builder --config .config/electron-build-config.js
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>files</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#75715e>// &#39;index.js&#39;, &#39;main/**/*&#39;, &#39;dist/**/*&#39;, &#39;node_modules/&#39;, &#39;package.json&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;**/*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;!release/**/*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;!renderer/**/*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;dist/**/*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;static/**/*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;!src/**/*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// &#34;!main/**/*&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  ],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>productName</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;demoApp&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 注入打包后package.json 内的属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>extraMetadata</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>main</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;index.js&#39;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>directories</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;release/${version}&#39;</span>, <span style=color:#75715e>// 编译文件输出文件夹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  <span style=color:#75715e>// mac打包配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>mac</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 包类型，参见 https://developer.apple.com/library/ios/documentation/General/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html#//apple_ref/doc/uid/TP40009250-SW8
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// category: &#39;public.app-category.developer-tools&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;development&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;default&#39;</span>], <span style=color:#75715e>// 目标包类型，
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dmg</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// background: &#39;build/appdmg.png&#39;, // dmg安装窗口背景图
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// icon: &#39;public/icon.icns&#39;, // 客户端图标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>iconSize</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>100</span>, <span style=color:#75715e>// 安装图标大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 安装窗口中包含的项目和配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>contents</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>380</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>280</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;link&#39;</span>, <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/Applications&#39;</span> },
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>110</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>280</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;file&#39;</span> },
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    window<span style=color:#f92672>:</span> { <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>500</span>, <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>500</span> }, <span style=color:#75715e>// 安装窗口大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>linux</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;AppImage&#39;</span>, <span style=color:#e6db74>&#39;deb&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;build/icon.png&#39;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>win</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;nsis&#39;</span>, <span style=color:#e6db74>&#39;portable&#39;</span>, <span style=color:#e6db74>&#39;squirrel&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;public/icon.ico&#39;</span>, <span style=color:#75715e>// 客户端图标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>nsis</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>shortcutName</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;demoApp&#39;</span>, <span style=color:#75715e>// 图标名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>oneClick</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>, <span style=color:#75715e>// 是否一键安装
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>allowElevation</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 允许请求提升。 如果为false，则用户必须使用提升的权限重新启动安装程序。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>allowToChangeInstallationDirectory</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 允许修改安装目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// installerIcon: &#34;./dist/public/icon.ico&#34;,// 安装图标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// uninstallerIcon: &#34;./dist/public/unist.ico&#34;,//卸载图标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// installerHeaderIcon: &#34;./dist/public/icon.ico&#34;, // 安装时头部图标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>createDesktopShortcut</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 创建桌面图标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>createStartMenuShortcut</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 创建开始菜单图标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  <span style=color:#75715e>// asar: {
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>//   smartUnpack: true,  // asar打包, 智能提取第三方模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// },
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// asar: false,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>/* 
</span></span></span><span style=display:flex><span><span style=color:#75715e>  publish: [
</span></span></span><span style=display:flex><span><span style=color:#75715e>    {
</span></span></span><span style=display:flex><span><span style=color:#75715e>      provider: &#39;generic&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>      url: &#39;http://localhost/release/&#39;,//更新服务器地址,请按实际部署修改
</span></span></span><span style=display:flex><span><span style=color:#75715e>    },
</span></span></span><span style=display:flex><span><span style=color:#75715e>  ], */</span>
</span></span><span style=display:flex><span>};
</span></span></code></pre></div></p></details><h3 id=修改packagejson>修改<code>package.json</code></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span> <span style=color:#e6db74>&#34;scripts&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;elt:dev&#34;</span>: <span style=color:#e6db74>&#34;cross-env NODE_ENV=development electron .&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;start:app&#34;</span>: <span style=color:#e6db74>&#34;cross-env APP_ROOT=./renderer umi dev&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;concurrently \&#34;npm run start:app\&#34; \&#34;wait-on http://localhost:8000 &amp;&amp; npm run elt:dev\&#34;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;elt:dist&#34;</span>: <span style=color:#e6db74>&#34;umi electron-builder -p never&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;build:app&#34;</span>: <span style=color:#e6db74>&#34;cross-env APP_ROOT=./renderer umi build&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;elt:dist:all&#34;</span>: <span style=color:#e6db74>&#34;cross-env ELECTRON_MIRROR=https://npm.taobao.org/mirrors/electron/ electron-builder -mwl --config ./electron-builder-config.js&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;elt:dist:mac&#34;</span>: <span style=color:#e6db74>&#34;cross-env ELECTRON_MIRROR=https://npm.taobao.org/mirrors/electron/ electron-builder -m --config ./electron-builder-config.js&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;elt:dist:win&#34;</span>: <span style=color:#e6db74>&#34;cross-env ELECTRON_MIRROR=https://npm.taobao.org/mirrors/electron/ electron-builder -w --config ./electron-builder-config.js&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;elt:dist:linux&#34;</span>: <span style=color:#e6db74>&#34;cross-env ELECTRON_MIRROR=https://npm.taobao.org/mirrors/electron/ electron-builder -l --config ./electron-builder-config.js&#34;</span>
</span></span><span style=display:flex><span>  }<span style=color:#960050;background-color:#1e0010>,</span>
</span></span></code></pre></div><h3 id=执行编译>执行编译</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ yarn run elt:dist:mac
</span></span></code></pre></div><h3 id=遇到的问题>遇到的问题</h3><ol><li>在编译的时候报以下这个错
<code>Application entry file "/Users/mac/zones/electron-umi-template/release/mac/electron-app-template.app/Contents/Resources/app/index.js" does not exist. Seems like a wrong configuration.</code></li></ol><h3 id=解决方案>解决方案</h3><ol><li>思来想去，发现是文件夹重名了，原来我的渲染进程的文件夹是<code>app</code> ，而<code>electron-builder</code>打包出的入口文件夹也是<code>app</code>。将文件夹名字改成了<code>renderer</code>就解决了。</li></ol></article></div></div></div><aside class="column single-sidebar is-one-quarter"><div class=card><div class=card-info><div class=avatar><div class="image-wrapper ratio-1x1"><img src=/images/_avatar.jpg></div></div><div class=info><span class=info-name>WannTonn</span>
<span class=info-para>为他人期待而活才是小丑🤡</span></div><div class=counter><div class=counter-wrapper><span class=counter-data>19</span>
<span class=counter-name>kWords</span></div><div class=counter-wrapper><span class=counter-data>10</span>
<span class=counter-name>Tags</span></div><div class=counter-wrapper><span class=counter-data>29</span>
<span class=counter-name>Posts</span></div></div></div></div><div class=sticky><div class="card toc hidden" id=table-of-contents><nav id=TableOfContents><ul><li><ul><li><a href=#使用-umi-创建-react-项目此处为-macos-环境>使用 Umi 创建 React 项目(此处为 MacOS 环境)</a></li><li><a href=#安装依赖与运行项目>安装依赖与运行项目</a></li><li><a href=#准备安装-electron>准备安装 Electron</a></li><li><a href=#修改根目录indexjs>修改根目录<code>index.js</code></a></li><li><a href=#修改根目录packagejson>修改根目录<code>package.json</code></a></li><li><a href=#运行-electron>运行 Electron</a></li><li><a href=#细节修改>细节修改</a></li><li><a href=#再次运行-electron>再次运行 Electron</a></li><li><a href=#安装electron-builder>安装<code>electron-builder</code></a></li><li><a href=#添加electron-builder配置>添加<code>electron-builder</code>配置</a></li><li><a href=#修改packagejson>修改<code>package.json</code></a></li><li><a href=#执行编译>执行编译</a></li><li><a href=#遇到的问题>遇到的问题</a></li><li><a href=#解决方案>解决方案</a></li></ul></li></ul></nav></div></div></aside></div></div></main><footer class=footer><div class=container><span>Copyright &copy; 2020-2023 WannTonn</span>
<span>Original theme <a href=https://github.com/amzrk2/hugo-template-aofuji target=_blank>Aofuji</a> with Apache-2.0 license</span></div></footer><script defer src=/assets/amzrk2-common.min.js></script>
<script defer src=/assets/amzrk2-single.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.21.0/components/prism-core.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.21.0/plugins/autoloader/prism-autoloader.min.js></script></body></html>